<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mishmish Server ğŸŒ¸</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { background: #121212; color: white; text-align: center; font-family: sans-serif; padding: 20px; margin: 0; }
        .note { color: #ff9f43; font-size: 26px; margin: 20px 0; font-weight: bold; min-height: 40px; }
        #mainImage { max-width: 90%; border-radius: 15px; box-shadow: 0 4px 15px rgba(255,159,67,0.3); }
        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù„ØªÙƒÙˆÙ† Ù…ØªØ¬Ø§ÙˆØ¨Ø© Ù…Ø¹ Ø§Ù„Ø¬ÙˆØ§Ù„ */
        .video-wrapper { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 90%; margin: 20px auto; border-radius: 15px; display: none; border: 2px solid #ff9f43; }
        .video-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
    </style>
</head>
<body>

    <h1>Mishmish Server ğŸŒ¸</h1>
    
    <div id="noteDisplay" class="note">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>

    <img id="mainImage" src="" alt="Ù…ÙØ§Ø¬Ø£Ø© Ù…Ø´Ù…Ø´">

    <div id="videoContainer" class="video-wrapper">
        <iframe id="videoPlayer" src="" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://ourphotoshare-a874a-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        db.ref('note').on('value', (s) => { document.getElementById('noteDisplay').innerText = s.val() || ""; });

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        db.ref('main_image').on('value', (s) => { if(s.val()) document.getElementById('mainImage').src = s.val(); });

        // Ù…Ø­ÙˆÙ„ Ø±ÙˆØ§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨ Ø§Ù„Ø°ÙƒÙŠ
        function getEmbedUrl(url) {
            if (!url) return "";
            let videoId = "";
            if (url.includes("v=")) videoId = url.split("v=")[1].split("&")[0];
            else if (url.includes("youtu.be/")) videoId = url.split("youtu.be/")[1].split("?")[0];
            return videoId ? `https://www.youtube.com/embed/${videoId}?autoplay=1` : url;
        }

        // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙÙŠØ¯ÙŠÙˆ ÙˆØ¥Ø®ÙØ§Ø¡ Ø§Ù„ØµÙˆØ±Ø© Ø£Ùˆ Ø§Ù„Ø¹ÙƒØ³)
        db.ref('video_url').on('value', (snapshot) => {
            const url = snapshot.val();
            const container = document.getElementById('videoContainer');
            const player = document.getElementById('videoPlayer');
            const img = document.getElementById('mainImage');

            if(url && url.trim() !== "") {
                player.src = getEmbedUrl(url);
                container.style.display = 'block';
                img.style.display = 'none';
            } else {
                player.src = "";
                container.style.display = 'none';
                img.style.display = 'inline-block';
            }
        });
    </script>
</body>
</html>
