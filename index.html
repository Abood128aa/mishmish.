<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mishmish Space üå∏</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --main-color: #ff9f43; --bg-dark: #121212; --card-bg: rgba(255, 255, 255, 0.05); }
        body { background: var(--bg-dark); color: white; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        .header { margin-bottom: 30px; animation: fadeInDown 1s; }
        .header h1 { font-size: 24px; color: var(--main-color); letter-spacing: 2px; text-transform: uppercase; }

        .main-card { background: var(--card-bg); backdrop-filter: blur(10px); border-radius: 30px; border: 1px solid rgba(255,255,255,0.1); width: 100%; max-width: 500px; padding: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.4); transition: 0.5s; }
        
        .note-area { font-size: 22px; font-weight: bold; margin: 20px 0; color: #fff; line-height: 1.6; }
        
        #mediaContainer iframe { width: 100%; height: 400px; border-radius: 20px; border: 2px solid var(--main-color); box-shadow: 0 0 20px rgba(255,159,67,0.2); }

        .interaction-bar { display: flex; justify-content: space-around; margin: 25px 0; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; }
        .action-btn { background: none; border: none; color: #ccc; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 5px; transition: 0.3s; }
        .action-btn i { font-size: 24px; }
        .action-btn:hover { color: var(--main-color); }
        .action-btn span { font-size: 12px; font-weight: bold; }

        .comments-section { text-align: right; width: 100%; margin-top: 20px; }
        .comment-bubble { background: rgba(255,255,255,0.07); padding: 12px 18px; border-radius: 15px 15px 0 15px; margin-bottom: 10px; position: relative; animation: slideIn 0.5s; }
        .comment-text { font-size: 15px; color: #eee; }
        .reply-text { font-size: 13px; color: var(--main-color); margin-top: 8px; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.05); display: block; }

        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="header">
        <h1>Mishmish Server üå∏</h1>
    </div>

    <div class="main-card">
        <div id="noteDisplay" class="note-area">ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...</div>
        
        <div id="mediaContainer" style="display:none;">
            <iframe id="universalPlayer" src="" allowfullscreen></iframe>
        </div>

        <div class="interaction-bar">
            <button class="action-btn" onclick="react('like')"><i class="fas fa-heart"></i><span id="likeCount">0</span></button>
            <button class="action-btn" onclick="react('dislike')"><i class="fas fa-heart-broken"></i><span id="dislikeCount">0</span></button>
            <button class="action-btn"><i class="fas fa-comment-dots"></i><span id="commCount">0</span></button>
        </div>

        <div class="comments-section">
            <div id="commentsList"></div>
        </div>
    </div>

    <script>
        const firebaseConfig = { databaseURL: "https://ourphotoshare-a874a-default-rtdb.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // ÿ¨ŸÑÿ® ÿßŸÑŸÖÿ≠ÿ™ŸàŸâ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿä
        db.ref('post').on('value', (s) => {
            const data = s.val();
            const noteBox = document.getElementById('noteDisplay');
            const player = document.getElementById('universalPlayer');
            const container = document.getElementById('mediaContainer');

            if (data) {
                const content = data.content;
                if (content.startsWith('http')) {
                    noteBox.innerText = "ŸàÿµŸÑŸÉ ÿ±ÿßÿ®ÿ∑ ÿ¨ÿØŸäÿØ ‚ú®";
                    player.src = content; container.style.display = 'block';
                } else {
                    noteBox.innerText = content; container.style.display = 'none';
                }
            }
        });

        // ÿ¨ŸÑÿ® ÿßŸÑÿ™ÿπŸÑŸäŸÇÿßÿ™ ŸÖÿπ ÿßŸÑÿ±ÿØŸàÿØ
        db.ref('comments').on('value', (s) => {
            const list = document.getElementById('commentsList');
            list.innerHTML = "";
            let count = 0;
            s.forEach((child) => {
                count++;
                const c = child.val();
                let html = `<div class="comment-bubble">
                    <div class="comment-text">${c.text}</div>`;
                if(c.reply) html += `<span class="reply-text">üí¨ ÿ±ÿØ ÿßŸÑŸÖÿ¥ÿ±ŸÅ: ${c.reply}</span>`;
                html += `</div>`;
                list.innerHTML += html;
            });
            document.getElementById('commCount').innerText = count;
        });

        // ÿßŸÑÿ™ŸÅÿßÿπŸÑÿßÿ™
        db.ref('reactions').on('value', (s) => {
            const d = s.val() || {like:0, dislike:0};
            document.getElementById('likeCount').innerText = d.like;
            document.getElementById('dislikeCount').innerText = d.dislike;
        });

        function react(type) { db.ref('reactions/' + type).transaction(c => (c || 0) + 1); }
    </script>
</body>
</html>
